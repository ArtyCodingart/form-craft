# FormCraft
`FormCraft` - это центральный класс для работы с формами в SwiftUI.
Он управляет значениями полей, выполняет их валидацию, обрабатывает ошибки и контролирует процесс отправки.
Основная цель `FormCraft` - избавить разработчика от рутины: вы задаёте поля и правила, а библиотека автоматически обеспечивает корректность данных и отслеживает состояние формы.


## Конструктор

```swift
init(fields: Fields)
```

### Аргументы
- **fields: Fields** - структура полей, соответствующая `FormCraftFields`. В ней описываются все поля, их начальные значения и правила валидации.

## Свойства

- **`fields: Fields`** - текущее состояние полей формы.  

- **`registeredFields: [String]`** - список зарегистрированных имён полей. Используется для учёта полей, которые реально участвуют в валидации.  

- **`focusedFields: [String]`** - набор имён полей, которые находятся в фокусе (например, активные текстовые поля).  

- **`errorFields: [String: String]`** - словарь ошибок, ключ - имя поля, значение - текст ошибки.  

- **`validationFields: [Key: Task<Void, Never>]`** - словарь активных задач валидации.  

- **`validatedFields: [Key: Sendable]`** - словарь успешно провалидированных значений.  

- **`formState: FormCraftFormState`** - общее состояние формы.  
  Содержит:  

  | Свойство | Тип   | Назначение |
  |---|---|---|
  | `isSubmitting` | `Bool` | Находится ли форма в процессе «отправки». Обычно используют для дизейбла кнопки «Отправить» и показа индикатора загрузки. |  

## Методы

### Регистрация

- **`registerField(key:name:)`** - добавляет поле в список отслеживаемых.  
- **`unregisterField(key:)`** - убирает поле из списка.  

---

### Установка значений

- **`setValue(key:value:config:)`** - меняет значение одного поля.  
  Если в `config` указано `shouldValidate = true`, поле сразу проверяется.  

- **`setValues(values:)`** - обновляет сразу несколько полей за один раз.  

---

### Ошибки

- **`setError(key:message:)`** - назначает ошибку конкретному полю.  
- **`setErrors([String:String])`** - устанавливает ошибки по именам.  
- **`setErrors([Key:String])`** - устанавливает ошибки по ключам.  
- **`clearError(key:)`** - очищает ошибку у одного поля.  
- **`clearErrors()`** - очищает все ошибки.  

---

### Валидация

- **`validateField(key:)`** - асинхронно проверяет одно поле.  
- **`validateFields()`** - проверяет все поля и возвращает `true`, если ошибок нет.  

---

### Отправка формы

- **`handleSubmit(onSuccess:)`** - возвращает замыкание для кнопки «Отправить».  
  При вызове:  
  1. ставит `isSubmitting = true`;  
  2. валидирует все поля;  
  3. если всё ок - вызывает `onSuccess` с валидными данными;  
  4. сбрасывает `isSubmitting = false`.  
